<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-11-13">

<title>Évaluation - Programmation Web pour la visualisation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="examen_files/libs/clipboard/clipboard.min.js"></script>
<script src="examen_files/libs/quarto-html/quarto.js"></script>
<script src="examen_files/libs/quarto-html/popper.min.js"></script>
<script src="examen_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="examen_files/libs/quarto-html/anchor.min.js"></script>
<link href="examen_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="examen_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="examen_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="examen_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="examen_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link rel="stylesheet" href="./css/tps.css">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Évaluation - Programmation Web pour la visualisation</h1>
<p class="subtitle lead">BUT Science des données - 3ème année - Université Grenoble Alpes</p>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 13, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="modalités" class="level2">
<h2 class="anchored" data-anchor-id="modalités">Modalités</h2>
<ul>
<li><p>Il s’agit d’un <strong>travail individuel</strong> d’une durée de <strong>2h00</strong> (<strong>2h40</strong> pour les étudiant.e.s concerné.e.s par un tiers-temps), à réaliser sur les machines de la salle informatique (pas d’utilisation d’ordinateur personnel). Vous devez rendre votre travail sur <a href="https://chamilo.iut2.univ-grenoble-alpes.fr/courses/BUT3SDVCOD507/">l’espace dédié au cours “BUT3 SD R5.VCOD.07 : Programmation web pour la visualisation” sur Chamilo</a> dans la rubrique “Travaux” (votre rendu doit être un fichier ZIP contenant l’ensemble des fichiers nécessaires à l’affichage de votre page : document HTML, code JavaScript, etc.).</p></li>
<li><p>Vous avez le droit d’utiliser tous les documents que vous souhaitez (cours, notes, etc.) ainsi que de faire des recherches sur le Web.</p></li>
<li><p>Les <strong>outils permettant de communiquer, ou de partager des documents, entre vous ou avec des tiers (mail, chat, <em>signal</em>, <em>telegram</em>, <em>dropbox</em>, etc.)</strong> ainsi que les <strong>IA génératives (ChatGPT, Gemini, etc.) ne sont pas autorisés</strong>.</p></li>
</ul>
</section>
<section id="consignes" class="level2">
<h2 class="anchored" data-anchor-id="consignes">Consignes</h2>
<p>Vous devez construire une page HTML présentant l’état actuel de la disponibilité des vélos en libre-service du service <a href="https://data.grandlyon.com/portail/fr/jeux-de-donnees/stations-velo-v-metropole-lyon-disponibilites-temps-reel/info"><em>Vélo’v de la Métropole de Lyon</em></a> (disponible à Lyon et dans une vingtaine de communes de la Métropole).</p>
<p><strong>Cette page doit contenir les éléments suivants</strong> :</p>
<ul>
<li><p><strong>un titre</strong></p></li>
<li><p>un pied de page avec <strong>la date de réalisation de la page, la date de mise à jour des données et le nom de l’auteur.trice</strong> (la date de réalisation de la page est donc écrite “en dure” alors que la date de mise à jour des données est générée avec du code JavaScript),</p></li>
<li><p><strong>une carte Leaflet</strong> (avec le fond de carte de votre choix) affichant les différentes stations présentes dans le jeu de données ; <strong>le marqueur doit être d’une couleur différente selon le taux de remplissage de la station</strong> (la couleur associée au taux de remplissage est indiqué dans la variable <code>availability</code> du jeu de données : ‘Vert’, ‘Orange’ ou ‘Rouge’).</p></li>
<li><p>un 1er <strong>graphique</strong>, réalisé avec Plot <strong>permettant de visualiser la répartition (à l’échelle de l’ensemble du réseau) entre places libres, vélos électriques disponibles et vélos mécaniques disponibles</strong> - vous devez ajouter les textes <em>“électrique”</em> et <em>“mécanique”</em> pour distinguer le type de vélo, comme dans l’exemple fourni (voir Figure 1 ci-dessous),</p></li>
<li><p>un 2nd <strong>graphique</strong> réalisé avec Plot, <strong>permettant de visualiser la capacité totale cumulée par ville / arrondissement</strong>, sous forme d’un diagramme à barres, comme dans l’exemple fourni (voir Figure 2 ci-dessous).</p></li>
<li><p><strong>Lors d’un clic sur un marqueur de la carte, un popup doit s’ouvrir</strong> et afficher les informations suivantes : <br> numéro de la station et nom de la station, adresse, nombre de vélos électriques disponibles, nombre de vélos mécaniques disponibles, nombre de docks vides (cf.&nbsp;Figure 3 ci-dessous).</p></li>
</ul>
<p>Puisqu’il s’agit d’un jeu de données en temps réel, et parce que la carte ainsi que le premier graphique représentent des informations qui varient fortement au cours de la journée, il est nécessaire de mettre à jour les données, et donc les graphiques et la carte, à intervalles réguliers (par exemple toutes les 5 minutes).</p>
<p>Optons pour la solution la plus simple : un rechargement total de la page. <strong>Vous devez écrire le code JavaScript permettant de recharger la page automatiquement toutes les 5 minutes.</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/tp-final-graphique1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure 1 : Exemple pour le graphique 1</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/tp-final-graphique2.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure 2 : Exemple pour le graphique 2</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/tp-final-popup.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure 3 : Exemple de popup</figcaption>
</figure>
</div>
<p>Pour rappel, votre page HTML doit importer les éléments suivants :</p>
<ul>
<li>le fichier CSS de leaflet :</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;link</span> <span class="er">rel</span><span class="ot">=</span><span class="st">"stylesheet"</span> <span class="er">href</span><span class="ot">=</span><span class="st">"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ot">    integrity=</span><span class="st">"sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ot">    crossorigin=</span><span class="st">""</span><span class="kw">/&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>le fichier JS de leaflet :</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;script</span> <span class="er">src</span><span class="ot">=</span><span class="st">"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ot">      integrity=</span><span class="st">"sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ot">      crossorigin=</span><span class="st">""</span><span class="kw">&gt;&lt;/script&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>le fichier JS de D3.js :</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;script</span> <span class="er">src</span><span class="ot">=</span><span class="st">"https://cdn.jsdelivr.net/npm/d3@7"</span><span class="kw">&gt;&lt;/script&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>le fichier JS de Plot :</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;script</span> <span class="er">src</span><span class="ot">=</span><span class="st">"https://cdn.jsdelivr.net/npm/@observablehq/plot@0.6"</span><span class="kw">&gt;&lt;/script&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>par ailleurs, vous aurez besoin d’inclure le fichier JS qui contiendra votre code JavaScript (que vous pouvez nommer comme vous le souhaitez) :</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;script</span> <span class="er">src</span><span class="ot">=</span><span class="st">"index.js"</span><span class="kw">&gt;&lt;/script&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="jeu-de-données" class="level3">
<h3 class="anchored" data-anchor-id="jeu-de-données">Jeu de données</h3>
<p><strong>Pour récupérer les données, vous devez utiliser l’URL suivante : <a href="https://data.grandlyon.com/fr/datapusher/ws/rdata/jcd_jcdecaux.jcdvelov/all.json?maxfeatures=-1">https://data.grandlyon.com/fr/datapusher/ws/rdata/jcd_jcdecaux.jcdvelov/all.json?maxfeatures=-1</a></strong>.</p>
<p>La description du jeu de données peut être trouvée <a href="https://data.grandlyon.com/portail/fr/jeux-de-donnees/stations-velo-v-metropole-lyon-disponibilites-temps-reel/info">ici</a> mais la description qui est donnée ci-dessous doit vous permettre de réaliser l’ensemble des tâches demandées.</p>
<p>L’objet que vous récupérez est un objet JSON contenant 6 propriétés : <code>fields</code>, <code>layer_name</code>, <code>nb_results</code>, <code>table_alias</code>, <code>table_href</code> et <code>values</code>. Les entrées qui correspondent à chaque station sont dans le tableau correspondant à la propriété <code>values</code> (qui contient environ 410 entrées).</p>
<p>Pour chaque entrée du tableau <code>values</code>, vous trouverez notamment :</p>
<ul>
<li>une propriété <code>lat</code> et une propriété <code>lng</code> qui contiennent les coordonnées de la station,</li>
<li>une propriété <code>availability</code> qui contient le code couleur de disponibilité de la station (vert, orange ou rouge),</li>
<li>une propriété <code>available_bike_stands</code> qui contient le nombre de docks vides,</li>
<li>une propriété <code>available_bikes</code> qui contient le nombre de vélos disponibles,</li>
<li>une propriété <code>main_stands</code> qui contient une propriété <code>availabilities</code> qui contient le nombre de vélos électriques (<code>electricalBikes</code>) et mécaniques (<code>mechanicalBikes</code>) disponibles.</li>
</ul>
<p>Ainsi, normalement, pour chaque station, vous devriez pouvoir calculer la capacité totale de la station (nécessaire pour le 2nd graphique) avec la formule suivante : <code>available_bike_stands + available_bikes</code>.</p>
</section>
<section id="autres-éléments-à-prendre-en-compte" class="level3">
<h3 class="anchored" data-anchor-id="autres-éléments-à-prendre-en-compte">Autres éléments à prendre en compte</h3>
<ul>
<li>Lors de l’ouverture de la page, la carte doit être centrée et zoomée pour afficher l’ensemble des entrées du jeu de données.</li>
<li>Vous devez choisir les couleurs des graphiques pour ne pas utiliser les valeurs par défaut de Plot.</li>
<li>Vous chercherez à agencer votre page de manière à faire tenir l’ensemble des éléments dans la page (sans scroll vertical ni horizontal - cf.&nbsp;Figure 4).</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/tp-final-page-totale.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure 4 : Exemple de mise en page</figcaption>
</figure>
</div>
</section>
<section id="question-bonus" class="level3">
<h3 class="anchored" data-anchor-id="question-bonus">Question bonus</h3>
<p>Vous devez gérer le cas où le chargement des données échoue (par exemple si le serveur est indisponible, si l’utilisateur n’est pas connecté à Internet, etc.).</p>
<p>Si le chargement échoue, la page doit afficher un message d’erreur (cf.&nbsp;Figure 5 ci-dessous).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./img/tp-final-error.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure 5 : Exemple de page lorsque le chargement des données a échoué</figcaption>
</figure>
</div>
</section>
<section id="barème-indicatif" class="level3">
<h3 class="anchored" data-anchor-id="barème-indicatif">Barème indicatif :</h3>
<ul>
<li><p>Récupération des données : 1 point</p></li>
<li><p>Titre : 0.5 point</p></li>
<li><p>Pied de page : 1.5 points</p></li>
<li><p>Structure du document HTML et mise en page : 2.5 points</p></li>
<li><p>Carte, markers et popups : 5 points</p></li>
<li><p>Graphique 1 : 4 points</p></li>
<li><p>Graphique 2 : 4 points</p></li>
<li><p>Rechargement automatique de la page : 1.5 points</p></li>
<li><p>Question bonus : 1 point</p></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>